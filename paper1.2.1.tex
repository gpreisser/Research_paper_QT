\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}
\usepackage{amsfonts,amsmath, amssymb}
%\usepackage[spanish]{babel}
\usepackage{fancyhdr}
%\usepackage[none]{hyphenat}
\usepackage[nottoc, notlot, notlof]{tocbibind}
\usepackage{cite}
\usepackage{physics}
\usepackage{bm}
\usepackage[draft,inline,nomargin]{fixme} \fxsetup{theme=color}
\usepackage{enumitem}
\usepackage{a4wide}
\usepackage{dsfont}
\usepackage{ amssymb }
\usepackage{cite}
\usepackage[rightcaption]{sidecap}
\usepackage{graphicx}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{ragged2e}
\usepackage{pdfpages} 
\usepackage{csquotes}
\usepackage{listings}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=blue,      
    urlcolor=blue,
    citecolor=blue,
}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}

\title{Correlation between different emission channels from an atom inside a leaky driven cavity\\
%{\footnotesize \textsuperscript{*}Note: Sub-titles are not captured in Xplore and
%should not be used}
\thanks{corresponding author e-mail: guillermopreisser@hotmail.com}
}

\author{\IEEEauthorblockN{Guillermo Preisser and Pablo Barberis Blostein}
\IEEEauthorblockA{\textit{Instituto de Investigaciones en Matemáticas Aplicadas y en Sistemas,
} \\
\textit{Universidad Nacional Autónoma de México, Ciudad Universitaria, 04510, CDMX, México.}\\
Dated: 15 August, 2019}
}

\maketitle

\begin{abstract}
  A two level atom in free space does not show any correlation between
  photons emitted in different directions. We consider a two level
  atom inside a driven leaky cavity. We consider two atomic emission
  channels: emission to cavity modes and emission to no-cavity modes.
  Using the quantum trajectory formalism we study the correlation
  between photons emitted into cavity modes and that leak the cavity
  through its mirror, with photons that are emitted into the rest of
  the modes. We find that the cavity generates a correlation between
  the two emission channels.
\end{abstract}

%the recent advances?
\section{Introduction}
Spontaneous emission is a phenomenon that has been studied since the
early XX century \cite{10.2307/94746, 1917PhyZ...18..121E}. One of the
main characteristics of spontaneous emission is that
\fxnote{spontaneus emission no es exponencial, es aproximadamente
  exponencial, si quitas la aproximacion markoviana te queda una cola
  polinomial, quite la oracion} the exact time of emission, as well as
the direction in which the photon is emitted, is random, which
difficults its measurement. On the other hand, photons emitted from a
cavity are easy to measure, partly due the fact that we know that they
leave the cavity through one of the lateral mirrors \cite{326305,
  doi:10.1063/1.113345}. The randomness of the direction in which the
photons are emitted by atoms in free space difficults photon counting
experiments. To sort out this difficulty one could think of a physical
arrangement, in which the two-level atom is coupled to the stimulated
mode of a cavity, as it is shown in Fig. \ref{asa} (b). In this
physical arrangement, \fxnote*{tienes una cita donde lo nombren
  asi?}{which is known as the driven Jaynes-Cummings model}, one could
try to estimate the number of spontaneous emissions of the atom
--which are emitted in modes that are not cavity modes and therefore
escape the cavity-- by measuring the photons that leak through one of
the cavity mirrors. In the case that a
correlation exists between the two quantities, we can count the number
of photons that leak the cavity through its mirror, which is easy to
measure, to find information about the number of photons emitted into
the other modes (spontaneus emission), which are difficult to measure.
\begin{center}
\begin{figure*}\label{asa}
\begin{center}
\includegraphics[scale = 0.65]{newimagepaper.pdf}
%\includegraphics[scale = 0.45]{image_paper222.png}
\caption{\small{Physical arrangements of atom and atom in a cavity. In
    both of these arrangements we consider a source which stimulates
    the atom provoking it to spontaneously emit, once it decays. We
    consider a detector in two directions, and we keep a register of
    the number of photons measured in each direction. (a) In the case
    for the atom we don't expect a correlation between m (the number
    of photons measured in the upper side of the atom) and n (the
    number of photons measured in the right side of the atom); (b) for
    the atom in the cavity (a cavity with some loss rate) we study the
    possibility that the cavity generates a correlation between the
    emissions of the atom and the emissions of the cavity, which
    correspond to the emissions that leak through mirror
    2.}} \label{probdisult}
\end{center}
\end{figure*}
\end{center}


In the case of a two-level atom in free space, the absence of
correlation between different channels is the result of the markovian
approximation, which assumes that the environment has no memory of
previous interactions with the system \cite{daley2014quantum}. Two
atomic emissions would be correlated if one of the emissions stay
registered in the environment and, somehow, influence the second
emission of a two-level atom at a later time; the Markovian
approximation does not allow memory effects and there is no
correlation between the number of emissions of each source: knowing
the number of photons emitted in some region of the space during some
time does not give me any information on the number of photons emitted
in other region of the space. Nevertheless, for the case of an atom
inside a cavity, before a photon leaks the cavity, it will interact
with the atom for some time. This interaction with the atom before the
emission generates a correlation between photons that leak the cavity
through its mirror and photons that leak the cavity through its side.

We use quantum trajectory theory to theoretically calculate the
correlation between different emission channels. A quantum trajectory
is the description of a continuously monitored quantum system
conditioned on a particular past history of coherent evolution and
collapse \cite{Carmichael1993Open}. These trajectories are simulated
through a stochastic process, which define the times when the
collapses occur. Each trajectory gives us the number of photon emitted
in each channel. Simulating a large number of trajectories and
registering the number of photon emissions into the two channels, we
obtain its correlation. The correlation varies with the cavity
linewidth and the atom-cavity coupling. For a very bad cavity we
recover the free space result: there is no correlation between the two
channels.


This article is organized as follows: A general overview of the driven
Jaynes-Cummings model is presented in section \ref{sc:drivenjc}. In
section \ref{sc:distributions} we obtain probability distributions
that relate the number of spontaneous and cavity emissions. In section
\ref{sc:correlation} we calculate the correlation between the two variables.
Concluding remarks are given in section \ref{sc:conclusions}


\section{Driven Jaynes-Cummings model}\label{sc:drivenjc}
We consider a system consisting of a two-level atom, coupled to a mode
of a leaky cavity. The mode is driven by a coherent field resonant
with the atomic transition and the cavity mode.
% In order to account for
% dissipation one may use a non-hermitian Hamiltonian to describe the
% system \cite{bla}. Using this description for the system will turn
% useful at the moment of using quantum trajectory theory. Such
% Hamiltonian can be separated into hermitian and non-hermitian terms.
%\begin{equation}
%H = H_s - \frac{i\hbar}{2}\sum_m C^\dagger_n C_n .
%\end{equation}
The Hamiltonian of this system, in the rotating wave approximation is
given by
\begin{equation}
H_s = H_{at} + H_{cav} + H_{atcav} + H_{lascav}, \label{mainham}  
\end{equation}
where the atom and cavity terms are, respectively
\begin{subequations}
\begin{equation}
H_{at} = \tfrac{1}{2}\hbar \omega \sigma_z,    
\end{equation}
\begin{equation}
H_{cav} = \hbar \omega  a^\dagger a,  
\end{equation}
while the coupling between atom and cavity, and cavity and coherent
field are
\begin{equation}
H_{atcav} = i\hbar g(a\sigma_+ - a^\dagger \sigma_-),    
\end{equation}
\begin{equation}
H_{lascav} = i\hbar \mathcal{E}(ae^{i\omega t} - a^\dagger e^{-i\omega t}),    
\end{equation}
\end{subequations}
where the annihilation operator $a$ of a single photon in the cavity,
and the creation operator $a^\dagger$ obey $[a, a^\dagger] = 1$. The
operators $\sigma_-, \sigma_+$ account for the atomic lowering and
raising operators, respectively, and the operator $\sigma_z$ accounts
for the population difference between the atomic levels. These
operators obey
$[\sigma_+, \sigma_-] = \sigma_z, \ [\sigma_\pm, \sigma_z] = \mp
2\sigma_\pm$. The strength of the coupling between atom and cacity
field is given by the constant
\begin{equation}
g = \sqrt{\frac{\omega d^2}{2\hbar \epsilon_0 V_Q}},
\end{equation}
where $V_Q$ is the mode volume , $d$ is the atomic dipole , and
$\epsilon_0$ is the permitivity of free space. $\mathcal{E}$ is a term
proportional to the coherent field amplitude. Dissipation is
introduced by the following non-hermitian Hamiltonian
\begin{equation} \label{nh}
H_{nh} = H_{dec} + H_{leak},
\end{equation}
where the terms corresponding to spontaneous emission of the atom and cavity losses are
\begin{subequations}
\begin{equation}
H_{dec} = - i\hbar\frac{\gamma}{2}\sigma_+\sigma_-,
\end{equation}
\begin{equation}
H_{leak} = - i\hbar\kappa a^\dagger a\, .
\end{equation}
\end{subequations}
where $\kappa$ and $\gamma$ are the cavity loss and spontaneous decay
rate. The evolution between jumps is given by $H=H_s+H_{nh}$. This
evolution is interrumped by spontaneus emission by the atom or when a
photon leaks the cavity. 

We now summarize te quantum trajectory formalism \cite{bla} that we
use to solve the system. We start with a state which represents a
ground state of the atom with no photons in the cavity,
$\ket{\phi(t = 0)} = \ket{\downarrow} \times \ket{0}$, we evolve it
with the Schrödinger equation through some time $\delta t$, using the
non-hermitian Hamiltonian
\begin{equation}
H = H_s +H_{nh}\, .
\end{equation}
Using a non-hermitian Hamiltonian will have as a consequence that the
probability won't be conserved \cite{Sakurai:1167961}. The evolution
of the state through the schrödinger equation will be interrupted by a
quantum jump – an abrupt change on our state in which a photoemission
has ocurred. The probability for such quantum jump to happen will be
given by the collapse probability
\begin{equation} \label{probcol}
\delta p = \sum_n \delta p_n,
\end{equation}
where 
\begin{eqnarray} \label{relprob}
\delta p_1 &=& \gamma \bra{\phi (t)} \sigma_+
               \sigma_-\ket{\psi (t)}\delta t \\
  \delta p_2 &=& 2\kappa \bra{\phi (t)} a^\dagger a\ket{\psi (t)}\delta t 
\end{eqnarray}
We use these collapse probabilities to simulate the quantum
trajectories, where we compare the collapse probability of eq.
\eqref{probcol} with a random number $\epsilon$, uniformly distributed
between zero and one. In the case the condition $\delta p > \epsilon$
is fulfilled we simulate that a quantum jump has happened, by acting
with one of the collapse operators. The operator with which we'll act
on the state will be given according to the relative probabilities of
eq. \eqref{relprob}.
\begin{figure}[!t] 
\centering
\includegraphics[scale = 0.5]{distributioneng.pdf}
\caption{\small{Probability distribution of spontaneous emissions for different number of cavity losses in a driven Jaynes-cummings model, doing $100,000$ quantum trajectory simulations, with parameters $\mathcal{E}  = \kappa = \gamma = g = 1$.}} \label{probdiss}
\end{figure}
Using equation \eqref{probcol} one can easily identify the
corresponding collapse probabilities of the system. Having identified
the collapse operators and the collapse probability, we simulate
quantum trajectories, in which we keep count of the number of quantum
jumps for each collapse operator, relating the number of quantum jumps
associated to spontaneous emissions for each number of quantum jumps
associated to cavity emissions until we reach a maximum number of
cavity emissions, which we establish. The procedure of register of
emissions is summarized in algorithm \ref{alg1}.

Realizing a large number of these trajectories, storing the registers
in a matrix, where we keep track of the number of times that there
were certain number of spontaneous emissions for each different number
of cavity emission, enable us to obtain probability distributions that
relate these two quantities.



\section{Counting photons emitted in different channels}\label{sc:distributions}
In this section we use the quantum trajectory formalism to calculate
the distribution probability of the number of spontaneous emissions by
the atom conditioned to the number of photons that leaked the cavity
from its mirror .
\subsection{Probability distributions of emissions}

In Fig.\ref{probdiss} we see the probability of obtaining different number of spontaneous emissions for different number of cavity emissions. It is clear from the plot that our probability distributions are going to be more spread out as more time (and hence more cavity emissions) pass.


\begin{algorithm}[!t]
\caption{Pseudocode for register of cavity losses and atom's spontaneous emissions}
\label{alg1}
\begin{algorithmic}
\STATE $N$: number of temporal intervals
\STATE $N_A $: number of spontaneous emissions
\STATE $N_C$: number of cavity emissions
\STATE $N_{max}$: maximum number of cavity emissions
\STATE $N_{CA}$: matrix relating the number of cavity emissions with the number of spontaneous emissions
%\STATE $K [\equiv] contador$

\STATE
\STATE Initial conditions:
\STATE $N_A = 0; N_C = 0;$
\STATE $N_{CA} = \text{zeros}(N_{max},2);  k = 0;$ 

\STATE 

\FOR{$i = 1$ to N} 
\STATE $\ket{ \phi^1(t + \delta t)} = e^{-iH\delta t/\hbar}\ket{\phi (t)}$
\STATE$ \delta p_1 = \delta t\bra{\phi(t)}C^\dagger_1 C_1\ket{\phi(t)}$
\STATE $ \delta p_2 =  \delta t\bra{\phi(t)}C^\dagger_2 C_2\ket{\phi(t)}$
\STATE $\delta p = \delta p_1 + \delta p_2$
\IF {$\delta p > \epsilon$}
\IF{$ \tfrac{\delta p_1}{\delta p} > \epsilon$}
\STATE $\ket{\phi (t + \delta t)} = \frac{C_1 \ket{ \ \phi(t)}}{\sqrt \frac{\delta p_1}{\delta t}}$
\STATE $N_A = N_A + 1$
\ELSE
\STATE $\ket{\phi (t + \delta t)} = \frac{C_2 \ket{ \ \phi(t)}}{\sqrt \frac{\delta p_2}{\delta t}}$
\STATE $N_C = N_C + 1$
\STATE $N_{CA}[k+1,1] = N_C$
\STATE  $N_{CA}[k+1,2] = N_A$
\STATE $k = k+1$
\IF{$N_C == N_{max}$}
\STATE \textbf{\textit{break}}
\ENDIF

\ENDIF
\ELSE
\STATE $\ket{ \phi(t + \delta t)} = \frac{\ket{\phi^1 (t+ \delta t)}}{\sqrt{1-\delta p}}$
\STATE $t \ += \delta t$
\ENDIF
\ENDFOR
\RETURN  $N_{CA}$

\end{algorithmic}

\end{algorithm}



\begin{center}
\begin{figure*}[!t]\label{error2}
\begin{center}
\includegraphics[scale = 0.55]{newerrorppp.pdf}
\caption{\small{(a) Probability distributions for different mean number of spontaneous emissions $\mu$; (b) Calculation of variance with respect to the mean number of sponatenous emissions $\mu$. In both cases we consider $\expval{n} \approx 1$, $\gamma = 1.0$ , $\kappa = g = 0.1$ and $\mathcal{E} =  \kappa |\langle n \rangle|[1 + 2g^2/\gamma \kappa]$.}} \label{probdisult}
\end{center}
\end{figure*}
\end{center}
\subsection{Extracting data from the probability distributions}
Due to the complex dynamic of the driven Jaynes-Cummings system \cite{Carmichael1993Open}, it is important to know the dynamic that the system undergoes at the moment of obtaining the probability distributions, in order to have a better physical understanding of our results. In this case we opt for fixing the number of photons in the cavity.


We do this by solving what is known as the Maxwell-Bloch equations, which give the dynamic of our system for the variables  $\expval{a}, \expval{\sigma_-}$ and $\expval{\sigma_z}$ that correspond to the cavity field, atomic coherence, and atomic inversion respectively \cite{Alsing_1991}. For the case of the driven Jaynes-Cummings system, these equations are given by
\begin{subequations} \label{maxbloch}
\begin{equation} \label{bloch1}
\dot{z} = (g/2)v + \mathcal{E} - \kappa z,
\end{equation}
\begin{equation} \label{bloch2}
\dot{v} = gmz - (\gamma/2)v,
\end{equation}
\begin{equation} \label{bloch3}
\dot{m} = -2g(z^*v + v^*z) - \gamma(m + 2),
\end{equation}
\end{subequations} 
where we defined  $z = e^{i\omega t}\expval{a}$, $v = 2e^{i\omega t}\expval{\sigma_-}$ and $m = 2\expval{\sigma_z}$. Solving for the case in which our variables are constant we can obtain steady state solutions \cite{gagniuc2017markov}.  From \eqref{bloch1} one can obtain the equation
\begin{equation} \label{chaf1}
\expval{a}_{ss} = \frac{\mathcal{E}e^{-i\omega t} + g\expval{\sigma_-}_{ss}}{\kappa}.
\end{equation}
While from \eqref{bloch2} and \eqref{bloch3} one obtains
\begin{equation} \label{chaf2}
\expval{\sigma_-}_{ss} = -\frac{2g}{\gamma}\frac{\expval{a}_{ss}}{1 + \frac{8g^2}{\gamma^2}|\expval{a}_{ss}|^2}.
\end{equation}
The requirement that both \eqref{chaf1} and \eqref{chaf2} are valid gives as result
\begin{equation}
\bigg(\frac{\mathcal{E}}{\kappa}\bigg)^2 = |\expval{a}_{ss}|^2 \bigg(1 + \frac{2g^2}{\gamma \kappa}\frac{1}{1 + \frac{8g^2}{\gamma^2}|\expval{a}_{ss}|^2}\bigg)^2.
\end{equation}
Considering $\gamma \gg g$, it is possible to clear $|\expval{a}|^2$, which allow us to obtain an expression for the expected value of the number of photons in the cavity
\begin{equation} \label{numfo}
|\expval{a}_{ss}|^2 = \bigg(\frac{\mathcal{E}/\kappa}{1 + 2g^2/\gamma \kappa}\bigg)^2.
\end{equation}
\begin{figure}[!t]  
\centering
\includegraphics[scale = 0.45]{newsigmaeng.pdf}
\caption{\small{Average number of spontaneous emissions $\pm \sigma$ with respect to cavity emissions, under parameters $\expval{n} \approx 1$, $\gamma = 1$ , $\kappa = g = 0.1$ and $\mathcal{E} =  \kappa |\langle n \rangle|[1 + 2g^2/\gamma \kappa]$.}}
\label{graph}
\end{figure} 
Having Eq. \eqref{numfo} we are able to stablish a dynamic in the system in which we fix the number of photons. Fixing the photon number to one and leaving $\mathcal{E}$ as a free parameter, we obtain probability distributions of the number of spontaneous emissions $E_i$ for different mean number of spontaneous emissions just as we see in Fig. \ref{probdisult} (a). From these probability distributions we can calculate the variance and graph it against the mean value as we see in Fig. \ref{probdisult} (b), where we obtain a variance almost equal to the mean value, something which is characteristic of Poisson distributions. 
Finally we can graph the mean value of spontaneous emissions against the number of cavity emissions considering standard deviation in order to have a better grasp of the certainty in the estimations, something that is shown in Fig. \ref{graph}.

\section{Correlation between photons emitted in different channels}\label{sc:correlation}
So far we have obtained estimations for the number of spontaneous emission for each measured number of cavity emissions. From our results it is obvious how the number of spontaneous emissions will increase with respect to the number of cavity emissions, given that more time will pass and more emissions will occur. One can also see how increasing the cavity linewidth $\kappa$ and keeping the other parameters constant will translate into a decrease of spontaneous emissions with respect to the number of cavity emissions. However, one question remains: is there a direct correlation between these two quantities? If yes, how this varies with respect to the cavity linewidth. From the beginning one could expect that in the case for a big $\kappa$ there would be no correlation at all, since this situation will be equivalent to the situation where there is no cavity. 

In order to have a measure of the correlation of the emissions we introduce the Pearson Correlation Coefficient \cite{benesty2009pearson}
\begin{equation} 
r_{xy} = \frac{\sum\limits_{i=1}^n(x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum\limits_{i=1}^n(x_i - \bar{x})^2\sum\limits_{i=1}^n(y_i - \bar{y})^2}}.  \label{correlationc}
\end{equation}
Having an equation that gives us a measure of the correlation, now we want the necessary data in order to obtain information about the correlation between the two types of emissions that we deal with. We can obtain this data by defining a temporal interval from which we make a register of the final number of spontaneous and cavity emissions. Given that what we are doing are essentially stochastic calculations, there will be variations in the final number of emissions for each trajectory. Making a large number of trajectories keeping track of the final number of emissions and pluggin the data in \eqref{correlationc} we are able to calculate the correlation.


\begin{center}
\begin{figure}[t!]
\begin{center}
\includegraphics[scale = 0.45]{million1.pdf}
\caption{\small{Calculation of correlation using 500 time intervals, fixing $\expval{n} \approx 1$, $\gamma =$ 1.0, $g = $ 0.1, and with  $\mathcal{E} =  \kappa |\langle n \rangle|[1 + 2g^2/\gamma \kappa]$.}} \label{corrxy}
\end{center}  
\end{figure}
\end{center}

\begin{center}
\begin{figure}[h!]
\begin{center}
\includegraphics[scale = 0.45]{million2.pdf}
\caption{\small{Correlation using different temporal intervals, fixing $\expval{n} \approx 1$, $\gamma =$ 1.0, $g =$ 0.1, and with  $\mathcal{E} =  \kappa |\langle n \rangle|[1 + 2g^2/\gamma \kappa]$.}}  \label{errorzz}
\end{center}
\end{figure}
\end{center}
%kncrease or increases
From Fig. \ref{corrxy} we see that, as we expected, the correlation goes to zero as we increase the cavity linewidth. Nonetheless, perhaps a more interesting question is: how high can this correlation be? Trying with values for $\kappa/\gamma$ lower than $0.1$, we notice that the correlation's increase stops and a decrease begins. It is possible that this stop in the increase of the correlation is due to the fact that if we keep decreasing the cavity linewidth it will come a point where the number of emissions will decrease considerably, diminishing the correlation. If this is the case we should expect that as we increase the temporal intervals, %the cavity linewidth at which the correlation starts decreasing should be smaller.
we also see an increment of the correlation.

%In Fig. \ref{errorzz} we can appreciate that, as we increase the total temporal interval, the cavity linewidth at which the correlation starts decreasing is smaller. This supports the idea that the time that takes for the system in stablishing the number photons will affect the minimum value of cavity linewidth at which the correlation starts decreasing.

In Fig. \ref{errorzz} we can appreciate that, as we increase the total temporal interval, there is also a slight increase in the correlation. This supports the idea that the time that takes for the system in stablishing the number photons will affect the value for the correlation, for values of $\kappa/\gamma$ lower than $0.1$.

\section{Conclusions}\label{sc:conclusions}
In this work we considered a driven Jaynes-Cummings system. We made a program in which, through the use of quantum trajectory theory, we were able to obtain probability distributions that relate the number of spontaneous emissions given certain number of cavity emissions. Through the probability distributions we obtained estimations for the number of spontaneous emissions by measuring cavity emissions, considering the correspondent error. Finally we study the existing correlation where we saw how this correlation decreases as we increase the cavity linewidth. However, if we try with values for  $\kappa/\gamma < 0.1$, there comes a point where the increase stops and we see a decrease. We believe this is related to the fact that if we use enough small values of $\kappa$ there will come a point where the emission of photons will be too low and this will imply a decrease in the correlation. The results in this work provide a tool that could be useful in the manipulation of single photons product of spontaneous emission, and provide insight into the physical behavior of the driven Jaynes-Cummings model.


\section*{Acknowledgment}

Support by UNAM, projects CONACyT and UNAM PAPIIT IG100518.


\bibliographystyle{IEEEtran}
\bibliography{reftesis}
\end{document}
